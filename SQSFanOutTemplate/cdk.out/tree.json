{"version":"tree-0.1","tree":{"id":"App","path":"","children":{"SQSFanOutTemplate":{"id":"SQSFanOutTemplate","path":"SQSFanOutTemplate","children":{"LambdaCodeS3ObjectVersion":{"id":"LambdaCodeS3ObjectVersion","path":"SQSFanOutTemplate/LambdaCodeS3ObjectVersion","constructInfo":{"fqn":"aws-cdk-lib.CfnParameter","version":"2.190.0"}},"LambdaCodeS3Bucket":{"id":"LambdaCodeS3Bucket","path":"SQSFanOutTemplate/LambdaCodeS3Bucket","constructInfo":{"fqn":"aws-cdk-lib.CfnParameter","version":"2.190.0"}},"LambdaCodeZipFile":{"id":"LambdaCodeZipFile","path":"SQSFanOutTemplate/LambdaCodeZipFile","constructInfo":{"fqn":"aws-cdk-lib.CfnParameter","version":"2.190.0"}},"LambdaCodeImageUri":{"id":"LambdaCodeImageUri","path":"SQSFanOutTemplate/LambdaCodeImageUri","constructInfo":{"fqn":"aws-cdk-lib.CfnParameter","version":"2.190.0"}},"LambdaCodeS3Key":{"id":"LambdaCodeS3Key","path":"SQSFanOutTemplate/LambdaCodeS3Key","constructInfo":{"fqn":"aws-cdk-lib.CfnParameter","version":"2.190.0"}},"IAMManagedPolicyPolicyserviceroleAWSLambdaBasicExecutionRole12a7b83263fb4700a64b79855bd0f6ad":{"id":"IAMManagedPolicyPolicyserviceroleAWSLambdaBasicExecutionRole12a7b83263fb4700a64b79855bd0f6ad","path":"SQSFanOutTemplate/IAMManagedPolicyPolicyserviceroleAWSLambdaBasicExecutionRole12a7b83263fb4700a64b79855bd0f6ad","attributes":{"aws:cdk:cloudformation:type":"AWS::IAM::ManagedPolicy","aws:cdk:cloudformation:props":{"description":"","groups":[],"managedPolicyName":"AWSLambdaBasicExecutionRole-12a7b832-63fb-4700-a64b-79855bd0f6ad","path":"/service-role/","policyDocument":{"Version":"2012-10-17","Statement":[{"Resource":"arn:aws:logs:us-east-1:361769557650:*","Action":"logs:CreateLogGroup","Effect":"Allow"},{"Resource":["arn:aws:logs:us-east-1:361769557650:log-group:/aws/lambda/sqs-message-logger:*"],"Action":["logs:CreateLogStream","logs:PutLogEvents"],"Effect":"Allow"}]},"roles":["lambda-sqs-access"],"users":[]}},"constructInfo":{"fqn":"aws-cdk-lib.aws_iam.CfnManagedPolicy","version":"2.190.0"}},"IAMManagedPolicyPolicyserviceroleAWSLambdaBasicExecutionRolec9016dd897564ea1b28c411330a967d6":{"id":"IAMManagedPolicyPolicyserviceroleAWSLambdaBasicExecutionRolec9016dd897564ea1b28c411330a967d6","path":"SQSFanOutTemplate/IAMManagedPolicyPolicyserviceroleAWSLambdaBasicExecutionRolec9016dd897564ea1b28c411330a967d6","attributes":{"aws:cdk:cloudformation:type":"AWS::IAM::ManagedPolicy","aws:cdk:cloudformation:props":{"description":"","groups":[],"managedPolicyName":"AWSLambdaBasicExecutionRole-c9016dd8-9756-4ea1-b28c-411330a967d6","path":"/service-role/","policyDocument":{"Version":"2012-10-17","Statement":[{"Resource":"arn:aws:logs:us-east-1:361769557650:*","Action":"logs:CreateLogGroup","Effect":"Allow"},{"Resource":["arn:aws:logs:us-east-1:361769557650:log-group:/aws/lambda/generate-thumbnail-lambda:*"],"Action":["logs:CreateLogStream","logs:PutLogEvents"],"Effect":"Allow"}]},"roles":["generate-thumbnail-role"],"users":[]}},"constructInfo":{"fqn":"aws-cdk-lib.aws_iam.CfnManagedPolicy","version":"2.190.0"}},"IAMManagedPolicyPolicyserviceroleAWSLambdaS3ExecutionRoleb1d9459c168544d6a7697e835365c9a8":{"id":"IAMManagedPolicyPolicyserviceroleAWSLambdaS3ExecutionRoleb1d9459c168544d6a7697e835365c9a8","path":"SQSFanOutTemplate/IAMManagedPolicyPolicyserviceroleAWSLambdaS3ExecutionRoleb1d9459c168544d6a7697e835365c9a8","attributes":{"aws:cdk:cloudformation:type":"AWS::IAM::ManagedPolicy","aws:cdk:cloudformation:props":{"description":"","groups":[],"managedPolicyName":"AWSLambdaS3ExecutionRole-b1d9459c-1685-44d6-a769-7e835365c9a8","path":"/service-role/","policyDocument":{"Version":"2012-10-17","Statement":[{"Resource":"arn:aws:s3:::*","Action":["s3:GetObject"],"Effect":"Allow"}]},"roles":["generate-thumbnail-role"],"users":[]}},"constructInfo":{"fqn":"aws-cdk-lib.aws_iam.CfnManagedPolicy","version":"2.190.0"}},"IAMManagedPolicyPolicyserviceroleAWSLambdaSQSPollerExecutionRole230286410fcc43d4a53411ff12cc32a3":{"id":"IAMManagedPolicyPolicyserviceroleAWSLambdaSQSPollerExecutionRole230286410fcc43d4a53411ff12cc32a3","path":"SQSFanOutTemplate/IAMManagedPolicyPolicyserviceroleAWSLambdaSQSPollerExecutionRole230286410fcc43d4a53411ff12cc32a3","attributes":{"aws:cdk:cloudformation:type":"AWS::IAM::ManagedPolicy","aws:cdk:cloudformation:props":{"description":"","groups":[],"managedPolicyName":"AWSLambdaSQSPollerExecutionRole-23028641-0fcc-43d4-a534-11ff12cc32a3","path":"/service-role/","policyDocument":{"Version":"2012-10-17","Statement":[{"Resource":"arn:aws:sqs:us-east-1:361769557650:*","Action":["sqs:DeleteMessage","sqs:GetQueueAttributes","sqs:ReceiveMessage"],"Effect":"Allow","Sid":"AWSLambdaSQSPollerExecutionRole"}]},"roles":["generate-thumbnail-role"],"users":[]}},"constructInfo":{"fqn":"aws-cdk-lib.aws_iam.CfnManagedPolicy","version":"2.190.0"}},"IAMManagedPolicyPolicyserviceroleAWSLambdaSQSPollerExecutionRole262bfa723639406fa3052f99a112e8a5":{"id":"IAMManagedPolicyPolicyserviceroleAWSLambdaSQSPollerExecutionRole262bfa723639406fa3052f99a112e8a5","path":"SQSFanOutTemplate/IAMManagedPolicyPolicyserviceroleAWSLambdaSQSPollerExecutionRole262bfa723639406fa3052f99a112e8a5","attributes":{"aws:cdk:cloudformation:type":"AWS::IAM::ManagedPolicy","aws:cdk:cloudformation:props":{"description":"","groups":[],"managedPolicyName":"AWSLambdaSQSPollerExecutionRole-262bfa72-3639-406f-a305-2f99a112e8a5","path":"/service-role/","policyDocument":{"Version":"2012-10-17","Statement":[{"Resource":"arn:aws:sqs:us-east-1:361769557650:*","Action":["sqs:DeleteMessage","sqs:GetQueueAttributes","sqs:ReceiveMessage"],"Effect":"Allow","Sid":"AWSLambdaSQSPollerExecutionRole"}]},"roles":["lambda-sqs-access"],"users":[]}},"constructInfo":{"fqn":"aws-cdk-lib.aws_iam.CfnManagedPolicy","version":"2.190.0"}},"S3BucketImguploadiac2025resized":{"id":"S3BucketImguploadiac2025resized","path":"SQSFanOutTemplate/S3BucketImguploadiac2025resized","attributes":{"aws:cdk:cloudformation:type":"AWS::S3::Bucket","aws:cdk:cloudformation:props":{"bucketEncryption":{"serverSideEncryptionConfiguration":[{"bucketKeyEnabled":true,"serverSideEncryptionByDefault":{"sseAlgorithm":"AES256"}}]},"bucketName":"img-upload-iac2025-resized","ownershipControls":{"rules":[{"objectOwnership":"BucketOwnerEnforced"}]},"publicAccessBlockConfiguration":{"restrictPublicBuckets":true,"ignorePublicAcls":true,"blockPublicPolicy":true,"blockPublicAcls":true}}},"constructInfo":{"fqn":"aws-cdk-lib.aws_s3.CfnBucket","version":"2.190.0"}},"SQSQueueNewimguploadqueue":{"id":"SQSQueueNewimguploadqueue","path":"SQSFanOutTemplate/SQSQueueNewimguploadqueue","attributes":{"aws:cdk:cloudformation:type":"AWS::SQS::Queue","aws:cdk:cloudformation:props":{"delaySeconds":0,"maximumMessageSize":262144,"messageRetentionPeriod":345600,"queueName":"new-img-upload-queue","receiveMessageWaitTimeSeconds":0,"sqsManagedSseEnabled":true,"visibilityTimeout":30}},"constructInfo":{"fqn":"aws-cdk-lib.aws_sqs.CfnQueue","version":"2.190.0"}},"IAMRoleGeneratethumbnailrole":{"id":"IAMRoleGeneratethumbnailrole","path":"SQSFanOutTemplate/IAMRoleGeneratethumbnailrole","attributes":{"aws:cdk:cloudformation:type":"AWS::IAM::Role","aws:cdk:cloudformation:props":{"assumeRolePolicyDocument":{"Version":"2012-10-17","Statement":[{"Action":"sts:AssumeRole","Effect":"Allow","Principal":{"Service":"lambda.amazonaws.com"}}]},"managedPolicyArns":[{"Ref":"IAMManagedPolicyPolicyserviceroleAWSLambdaSQSPollerExecutionRole230286410fcc43d4a53411ff12cc32a3"},"arn:aws:iam::aws:policy/AmazonS3FullAccess",{"Ref":"IAMManagedPolicyPolicyserviceroleAWSLambdaBasicExecutionRolec9016dd897564ea1b28c411330a967d6"},{"Ref":"IAMManagedPolicyPolicyserviceroleAWSLambdaS3ExecutionRoleb1d9459c168544d6a7697e835365c9a8"}],"maxSessionDuration":3600,"path":"/service-role/","policies":[{"policyDocument":{"Version":"2012-10-17","Statement":[{"Resource":"arn:aws:lambda:us-east-1:770693421928:layer:Klayers-p39-Pillow:1","Action":"lambda:GetLayerVersion","Effect":"Allow"}]},"policyName":"lambdaGetLayerPermission"},{"policyDocument":{"Version":"2012-10-17","Statement":[{"Resource":"*","Action":"s3:*","Effect":"Allow"}]},"policyName":"s3-full-access-lambda"}],"roleName":"generate-thumbnail-role"}},"constructInfo":{"fqn":"aws-cdk-lib.aws_iam.CfnRole","version":"2.190.0"}},"IAMRoleLambdasqsaccess":{"id":"IAMRoleLambdasqsaccess","path":"SQSFanOutTemplate/IAMRoleLambdasqsaccess","attributes":{"aws:cdk:cloudformation:type":"AWS::IAM::Role","aws:cdk:cloudformation:props":{"assumeRolePolicyDocument":{"Version":"2012-10-17","Statement":[{"Action":"sts:AssumeRole","Effect":"Allow","Principal":{"Service":"lambda.amazonaws.com"}}]},"managedPolicyArns":["arn:aws:iam::aws:policy/AmazonS3FullAccess",{"Ref":"IAMManagedPolicyPolicyserviceroleAWSLambdaSQSPollerExecutionRole262bfa723639406fa3052f99a112e8a5"},{"Ref":"IAMManagedPolicyPolicyserviceroleAWSLambdaBasicExecutionRole12a7b83263fb4700a64b79855bd0f6ad"}],"maxSessionDuration":3600,"path":"/service-role/","roleName":"lambda-sqs-access"}},"constructInfo":{"fqn":"aws-cdk-lib.aws_iam.CfnRole","version":"2.190.0"}},"SNSTopicImguploadspring2025124375":{"id":"SNSTopicImguploadspring2025124375","path":"SQSFanOutTemplate/SNSTopicImguploadspring2025124375","attributes":{"aws:cdk:cloudformation:type":"AWS::SNS::Topic","aws:cdk:cloudformation:props":{"archivePolicy":{},"fifoTopic":false,"subscription":[{"endpoint":{"Fn::GetAtt":["SQSQueueNewimguploadqueue","Arn"]},"protocol":"sqs"}],"topicName":"img-upload-spring-2025-124375","tracingConfig":"PassThrough"}},"constructInfo":{"fqn":"aws-cdk-lib.aws_sns.CfnTopic","version":"2.190.0"}},"LambdaFunctionGeneratethumbnaillambda":{"id":"LambdaFunctionGeneratethumbnaillambda","path":"SQSFanOutTemplate/LambdaFunctionGeneratethumbnaillambda","attributes":{"aws:cdk:cloudformation:type":"AWS::Lambda::Function","aws:cdk:cloudformation:props":{"architectures":["x86_64"],"code":{"s3ObjectVersion":{"Ref":"LambdaCodeS3ObjectVersion"},"s3Bucket":{"Ref":"LambdaCodeS3Bucket"},"zipFile":{"Ref":"LambdaCodeZipFile"},"imageUri":{"Ref":"LambdaCodeImageUri"},"s3Key":{"Ref":"LambdaCodeS3Key"}},"description":"An Amazon SQS trigger that logs messages in a queue.","ephemeralStorage":{"size":512},"fileSystemConfigs":[],"functionName":"generate-thumbnail-lambda","handler":"lambda_function.lambda_handler","layers":["arn:aws:lambda:us-east-1:361769557650:layer:my-lambda-pillow-layer:2","arn:aws:lambda:us-east-1:017000801446:layer:AWSLambdaPowertoolsPythonV3-python310-x86_64:11"],"loggingConfig":{"logFormat":"Text","logGroup":"/aws/lambda/generate-thumbnail-lambda"},"memorySize":128,"packageType":"Zip","role":{"Fn::GetAtt":["IAMRoleGeneratethumbnailrole","Arn"]},"runtime":"python3.9","runtimeManagementConfig":{"updateRuntimeOn":"Auto"},"tags":[{"key":"lambda-console:blueprint","value":"sqs-poller"}],"timeout":63,"tracingConfig":{"mode":"PassThrough"}}},"constructInfo":{"fqn":"aws-cdk-lib.aws_lambda.CfnFunction","version":"2.190.0"}},"S3BucketImguploadiac2025":{"id":"S3BucketImguploadiac2025","path":"SQSFanOutTemplate/S3BucketImguploadiac2025","attributes":{"aws:cdk:cloudformation:type":"AWS::S3::Bucket","aws:cdk:cloudformation:props":{"bucketEncryption":{"serverSideEncryptionConfiguration":[{"bucketKeyEnabled":true,"serverSideEncryptionByDefault":{"sseAlgorithm":"AES256"}}]},"bucketName":"img-upload-iac2025","notificationConfiguration":{"queueConfigurations":[],"topicConfigurations":[{"topic":{"Ref":"SNSTopicImguploadspring2025124375"},"filter":{"s3Key":{"rules":[{"value":"","name":"Prefix"},{"value":"","name":"Suffix"}]}},"event":"s3:ObjectCreated:*"}],"lambdaConfigurations":[]},"ownershipControls":{"rules":[{"objectOwnership":"BucketOwnerEnforced"}]},"publicAccessBlockConfiguration":{"restrictPublicBuckets":true,"ignorePublicAcls":true,"blockPublicPolicy":true,"blockPublicAcls":true}}},"constructInfo":{"fqn":"aws-cdk-lib.aws_s3.CfnBucket","version":"2.190.0"}},"CDKMetadata":{"id":"CDKMetadata","path":"SQSFanOutTemplate/CDKMetadata","children":{"Default":{"id":"Default","path":"SQSFanOutTemplate/CDKMetadata/Default","constructInfo":{"fqn":"aws-cdk-lib.CfnResource","version":"2.190.0"}},"Condition":{"id":"Condition","path":"SQSFanOutTemplate/CDKMetadata/Condition","constructInfo":{"fqn":"aws-cdk-lib.CfnCondition","version":"2.190.0"}}},"constructInfo":{"fqn":"constructs.Construct","version":"10.4.2"}},"BootstrapVersion":{"id":"BootstrapVersion","path":"SQSFanOutTemplate/BootstrapVersion","constructInfo":{"fqn":"aws-cdk-lib.CfnParameter","version":"2.190.0"}},"CheckBootstrapVersion":{"id":"CheckBootstrapVersion","path":"SQSFanOutTemplate/CheckBootstrapVersion","constructInfo":{"fqn":"aws-cdk-lib.CfnRule","version":"2.190.0"}}},"constructInfo":{"fqn":"aws-cdk-lib.Stack","version":"2.190.0"}},"Tree":{"id":"Tree","path":"Tree","constructInfo":{"fqn":"constructs.Construct","version":"10.4.2"}}},"constructInfo":{"fqn":"aws-cdk-lib.App","version":"2.190.0"}}}